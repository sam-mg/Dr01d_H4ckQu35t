We will be analyzing [FotaProvider.apk](./Files/FotaProvider.apk) for this exercise.

To begin with Android reversing, we need to identify the `MainActivity` from the `AndroidManifest.xml` file. Additionally, we can locate other entry points of the application by examining the `exported` tag.

Next, we need to explore methods to execute commands on a phone, either as a regular user or with privileged access. Resources like [StackOverflow](https://stackoverflow.com/questions/10277709/how-can-i-run-linux-commands-on-an-android-device) and [Android Developers](https://developer.android.com/reference/java/lang/ProcessBuilder) can be helpful.

The `AndroidManifest.xml` file provides valuable insights, such as intent filters and other entry points of the application.

Upon inspecting the `AndroidManifest.xml` file, we find the following:
```xml
<intent-filter>
    <action android:name="android.intent.action.AdupsFota.WriteCommandReceiver"/>
    <action android:name="android.intent.action.AdupsFota.OperReceiver"/>
</intent-filter>
```

Let’s investigate what this intent filter does.

Using `jadx-gui`, we uncover the following code:
```java
@Override // android.content.BroadcastReceiver
public void onReceive(Context context, Intent intent) {
    this.f175a = context;
    String action = intent.getAction();
    if (action.equalsIgnoreCase("android.intent.action.AdupsFota.WriteCommandReceiver")) {
        File file = new File(intent.getStringExtra("PackageFileName"));
        ((PowerManager) this.f175a.getSystemService("power")).newWakeLock(1, "FotaSys").acquire(5000L);
        try {
            RecoverySystem.installPackage(this.f175a, file);
            return;
        } catch (IOException e) {
            String str = "WriteCommandReceiver: Can't perform update system, IOException = " + e;
            return;
        }
    }
    if (action.equalsIgnoreCase("android.intent.action.AdupsFota.operReceiver")) {
        String stringExtra = intent.getStringExtra("cmd");
        String str2 = "cmd : " + stringExtra;
        if (stringExtra != null) {
            a(stringExtra.split(" "));
        }
    }
}
```

Now, let’s examine the `a` method:
```java
public static int a(String str) {
    "cmd = " + str;
    return a(str.split(" "));
}
```

From this, we can conclude that the app is capable of executing commands.

Finally, let’s determine the permission level. By reviewing the `AndroidManifest.xml` file, we find the following:
```xml
<manifest 
    android:sharedUserId="android.uid.system"
    package="com.adups.fota.sysoper">
```

This indicates that the app uses `android.uid.system`, granting it system-level permissions.